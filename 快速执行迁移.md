# å¿«é€Ÿæ‰§è¡Œæ•°æ®åº“è¿ç§»

## é—®é¢˜è¯´æ˜

`psql` å‘½ä»¤æ‰¾ä¸åˆ°æ˜¯å› ä¸º PostgreSQL çš„ bin ç›®å½•æ²¡æœ‰æ·»åŠ åˆ°ç³»ç»Ÿ PATH ç¯å¢ƒå˜é‡ä¸­ã€‚

## ğŸš€ è§£å†³æ–¹æ¡ˆï¼ˆä¸‰ç§æ–¹æ³•ï¼‰

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ PowerShell è„šæœ¬ï¼ˆæ¨èï¼Œè‡ªåŠ¨æŸ¥æ‰¾ psqlï¼‰

æˆ‘å·²ç»åˆ›å»ºäº†ä¸€ä¸ª PowerShell è„šæœ¬ï¼Œä¼šè‡ªåŠ¨æŸ¥æ‰¾ PostgreSQL çš„å®‰è£…è·¯å¾„ï¼š

```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
.\database\run-migration.ps1
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- âœ… è‡ªåŠ¨æŸ¥æ‰¾ PostgreSQL å®‰è£…è·¯å¾„
- âœ… ä» `.env` æ–‡ä»¶è¯»å–æ•°æ®åº“é…ç½®
- âœ… æ‰§è¡Œè¿ç§»è„šæœ¬
- âœ… éªŒè¯è¿ç§»ç»“æœ

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Node.js è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

å¦‚æœä½ å·²ç»å®‰è£…äº† Node.js å’Œé¡¹ç›®ä¾èµ–ï¼š

```powershell
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
node scripts/run-migration.js
```

**ä¼˜ç‚¹**ï¼š
- ä¸éœ€è¦ psql å‘½ä»¤
- è‡ªåŠ¨è¯»å– `.env` é…ç½®
- è‡ªåŠ¨éªŒè¯è¿ç§»ç»“æœ
- æ›´å‹å¥½çš„é”™è¯¯æç¤º

### æ–¹æ³•ä¸‰ï¼šæ‰‹åŠ¨æŒ‡å®š psql è·¯å¾„

å¦‚æœä½ çŸ¥é“ PostgreSQL çš„å®‰è£…è·¯å¾„ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å®Œæ•´è·¯å¾„ï¼š

```powershell
# ç¤ºä¾‹ï¼šPostgreSQL 16
& "C:\Program Files\PostgreSQL\16\bin\psql.exe" -U postgres -d fangdu_db -h localhost -p 5432 -f database/migrations/001_add_production_manager_features.sql

# æˆ–è€…è®¾ç½®ç¯å¢ƒå˜é‡åä½¿ç”¨
$env:PGPASSWORD="ä½ çš„å¯†ç "
& "C:\Program Files\PostgreSQL\16\bin\psql.exe" -U postgres -d fangdu_db -h localhost -p 5432 -f database/migrations/001_add_production_manager_features.sql
```

## ğŸ“ æŸ¥æ‰¾ PostgreSQL å®‰è£…è·¯å¾„

å¦‚æœä¸çŸ¥é“ PostgreSQL å®‰è£…åœ¨å“ªé‡Œï¼Œå¯ä»¥ï¼š

1. **åœ¨ PowerShell ä¸­æŸ¥æ‰¾**ï¼š
```powershell
# æŸ¥æ‰¾æ‰€æœ‰å¯èƒ½çš„ PostgreSQL å®‰è£…è·¯å¾„
Get-ChildItem "C:\Program Files" -Filter "PostgreSQL" -Directory -ErrorAction SilentlyContinue
Get-ChildItem "C:\Program Files (x86)" -Filter "PostgreSQL" -Directory -ErrorAction SilentlyContinue
Get-ChildItem "D:\" -Filter "PostgreSQL" -Directory -Recurse -ErrorAction SilentlyContinue -Depth 2
```

2. **åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æŸ¥æ‰¾**ï¼š
   - æ‰“å¼€ `C:\Program Files\PostgreSQL\`
   - æŸ¥çœ‹ç‰ˆæœ¬å·æ–‡ä»¶å¤¹ï¼ˆå¦‚ `16`, `15`, `14` ç­‰ï¼‰
   - è¿›å…¥ `bin` æ–‡ä»¶å¤¹ï¼Œç¡®è®¤æœ‰ `psql.exe`

3. **æ£€æŸ¥æœåŠ¡**ï¼š
```powershell
Get-Service | Where-Object {$_.Name -like "*postgres*"}
```

## ğŸ”§ æ°¸ä¹…è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ åˆ° PATH

å¦‚æœä½ æƒ³æ°¸ä¹…è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°† PostgreSQL çš„ bin ç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿ PATHï¼š

1. **é€šè¿‡ PowerShellï¼ˆå½“å‰ä¼šè¯ï¼‰**ï¼š
```powershell
$env:Path += ";C:\Program Files\PostgreSQL\16\bin"
```

2. **æ°¸ä¹…æ·»åŠ åˆ°ç³»ç»Ÿ PATH**ï¼š
   - å³é”®"æ­¤ç”µè„‘" â†’ "å±æ€§" â†’ "é«˜çº§ç³»ç»Ÿè®¾ç½®"
   - ç‚¹å‡»"ç¯å¢ƒå˜é‡"
   - åœ¨"ç³»ç»Ÿå˜é‡"ä¸­æ‰¾åˆ° `Path`ï¼Œç‚¹å‡»"ç¼–è¾‘"
   - ç‚¹å‡»"æ–°å»º"ï¼Œæ·»åŠ ï¼š`C:\Program Files\PostgreSQL\16\bin`ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®é™…è·¯å¾„ï¼‰
   - ç¡®å®šä¿å­˜

## âœ… æ¨èæ‰§è¡Œé¡ºåº

1. **é¦–é€‰**ï¼šä½¿ç”¨ Node.js è„šæœ¬ï¼ˆ`node scripts/run-migration.js`ï¼‰
   - æœ€ç®€å•ï¼Œä¸éœ€è¦é…ç½® PATH
   - è‡ªåŠ¨éªŒè¯ç»“æœ

2. **æ¬¡é€‰**ï¼šä½¿ç”¨ PowerShell è„šæœ¬ï¼ˆ`.\database\run-migration.ps1`ï¼‰
   - è‡ªåŠ¨æŸ¥æ‰¾ PostgreSQL è·¯å¾„
   - é€‚åˆ Windows ç¯å¢ƒ

3. **å¤‡é€‰**ï¼šæ‰‹åŠ¨æŒ‡å®š psql å®Œæ•´è·¯å¾„
   - éœ€è¦çŸ¥é“ PostgreSQL å®‰è£…ä½ç½®

## ğŸ¯ ç°åœ¨å°±å¼€å§‹

**æœ€ç®€å•çš„æ–¹æ³•**ï¼ˆæ¨èï¼‰ï¼š

```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
node scripts/run-migration.js
```

å¦‚æœ Node.js è„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Œå†å°è¯•ï¼š

```powershell
.\database\run-migration.ps1
```

